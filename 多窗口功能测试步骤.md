# TCClient 多窗口功能测试步骤

## 测试环境准备

1. **启动应用程序**
   ```bash
   cd TCClient
   dotnet run
   ```

2. **登录系统**
   - 使用有效的用户账户登录
   - 确保至少配置了一个交易账户

## 基础功能测试

### 测试1：市场总览窗口多开
**目标**：验证可以同时打开多个市场总览窗口

**步骤**：
1. 点击菜单：工具 → 市场总览
2. 验证窗口正常打开且显示在任务栏
3. 再次点击菜单：工具 → 市场总览
4. 验证第二个窗口打开，两个窗口可以同时存在
5. 检查主窗口状态栏显示：`MarketOverview: 2个`

**预期结果**：
- 两个市场总览窗口同时运行
- 每个窗口独立显示数据
- 状态栏正确显示窗口数量

### 测试2：推仓统计窗口多开
**目标**：验证可以为不同账户打开多个推仓统计窗口

**步骤**：
1. 在主窗口选择账户A
2. 点击菜单：查询 → 推仓统计
3. 验证窗口打开并显示账户A的数据
4. 在主窗口切换到账户B
5. 再次点击菜单：查询 → 推仓统计
6. 验证第二个窗口打开并显示账户B的数据
7. 检查状态栏显示：`PushStatistics: 2个`

**预期结果**：
- 两个推仓统计窗口同时运行
- 每个窗口显示对应账户的数据
- 窗口标题显示对应的账户ID

### 测试3：账户查询窗口多开
**目标**：验证可以同时打开多个账户查询窗口

**步骤**：
1. 选择账户A，打开账户查询窗口
2. 选择账户B，再次打开账户查询窗口
3. 验证两个窗口同时存在
4. 检查状态栏显示：`AccountQuery: 2个`

**预期结果**：
- 多个账户查询窗口可以同时运行
- 每个窗口显示对应账户的查询数据

### 测试4：服务管理器窗口多开
**目标**：验证可以打开多个服务管理器窗口

**步骤**：
1. 点击菜单：工具 → 服务管理器
2. 再次点击菜单：工具 → 服务管理器
3. 验证两个服务管理器窗口同时存在
4. 检查状态栏显示：`ServiceManager: 2个`

**预期结果**：
- 多个服务管理器窗口可以同时运行
- 每个窗口独立显示服务状态

## 混合场景测试

### 测试5：多类型窗口同时打开
**目标**：验证不同类型的窗口可以同时打开

**步骤**：
1. 打开2个市场总览窗口
2. 打开2个推仓统计窗口（不同账户）
3. 打开1个账户查询窗口
4. 打开1个服务管理器窗口
5. 检查状态栏显示：`MarketOverview: 2个, PushStatistics: 2个, AccountQuery: 1个, ServiceManager: 1个`

**预期结果**：
- 总共6个子窗口同时运行
- 状态栏正确显示所有窗口类型和数量
- 所有窗口正常工作，无性能问题

## 窗口管理测试

### 测试6：窗口状态更新
**目标**：验证窗口状态实时更新

**步骤**：
1. 打开多个不同类型的窗口
2. 观察状态栏显示的窗口状态
3. 手动关闭其中一个窗口
4. 验证状态栏自动更新窗口数量

**预期结果**：
- 状态栏实时反映当前打开的窗口状态
- 窗口关闭后状态立即更新

### 测试7：关闭所有子窗口功能
**目标**：验证一键关闭所有子窗口功能

**步骤**：
1. 打开多个不同类型的子窗口
2. 调用 `CloseAllChildWindows` 方法（通过菜单或快捷键）
3. 验证所有子窗口被关闭
4. 检查状态栏显示：`无打开的子窗口`

**预期结果**：
- 所有子窗口立即关闭
- 主窗口保持打开
- 状态栏正确更新

## 模态窗口测试

### 测试8：模态窗口行为验证
**目标**：验证模态窗口仍然正常工作

**步骤**：
1. 打开几个非模态窗口
2. 点击菜单：配置 → 账户管理（模态窗口）
3. 验证账户管理窗口以模态方式打开
4. 尝试点击其他窗口，验证无法操作
5. 关闭账户管理窗口
6. 验证其他窗口恢复正常操作

**预期结果**：
- 模态窗口正常阻塞其他窗口操作
- 关闭后其他窗口恢复正常

## 异常情况测试

### 测试9：窗口打开失败处理
**目标**：验证窗口打开失败时的错误处理

**步骤**：
1. 在未选择账户的情况下尝试打开推仓统计窗口
2. 验证显示错误提示："请先选择一个有效的交易账户"
3. 验证其他已打开的窗口不受影响

**预期结果**：
- 显示友好的错误提示
- 不影响其他窗口的正常运行

### 测试10：程序退出时的窗口清理
**目标**：验证程序退出时自动清理所有窗口

**步骤**：
1. 打开多个子窗口
2. 关闭主窗口或选择退出
3. 验证所有子窗口自动关闭
4. 验证程序完全退出，无残留进程

**预期结果**：
- 所有窗口正确关闭
- 程序完全退出
- 无内存泄漏或残留进程

## 性能测试

### 测试11：多窗口性能测试
**目标**：验证多窗口运行时的性能表现

**步骤**：
1. 逐步打开更多窗口（5个、10个、15个）
2. 观察系统资源使用情况
3. 测试窗口响应速度
4. 验证数据更新是否正常

**预期结果**：
- 在合理数量的窗口下性能良好
- 窗口响应及时
- 数据更新正常

## 用户体验测试

### 测试12：窗口布局和定位
**目标**：验证窗口的显示位置和布局

**步骤**：
1. 打开多个窗口
2. 验证窗口位置合理（居中或相对于父窗口）
3. 验证窗口大小适当
4. 验证任务栏图标显示正确

**预期结果**：
- 窗口位置合理，不重叠
- 窗口大小适中
- 任务栏正确显示窗口图标

## 测试结果记录

### 测试通过标准
- [ ] 所有非模态窗口可以同时打开多个实例
- [ ] 窗口状态正确显示和更新
- [ ] 关闭所有子窗口功能正常工作
- [ ] 模态窗口行为不受影响
- [ ] 异常情况处理正确
- [ ] 程序退出时正确清理资源
- [ ] 性能表现良好
- [ ] 用户体验友好

### 问题记录模板
```
测试项目：[测试名称]
问题描述：[详细描述遇到的问题]
重现步骤：[列出重现问题的具体步骤]
预期结果：[应该出现的正确结果]
实际结果：[实际观察到的结果]
严重程度：[高/中/低]
状态：[待修复/已修复/已验证]
```

## 自动化测试建议

### 未来可以添加的自动化测试
1. **单元测试**
   - WindowManagerService 的各个方法
   - 窗口注册和注销逻辑
   - 状态更新机制

2. **集成测试**
   - 窗口打开和关闭流程
   - 多窗口并发操作
   - 资源清理验证

3. **UI自动化测试**
   - 使用 UI 自动化框架测试窗口操作
   - 验证窗口显示状态
   - 测试用户交互流程 