# TCClient 项目总结文档

## 1. 系统概述

TCClient 是一个基于 WPF 开发的交易客户端系统，采用 MVVM 架构模式，实现了用户管理、数据库配置等基础功能。

## 2. 系统架构

### 2.1 技术栈
- 开发框架：.NET 9.0
- UI框架：WPF (Windows Presentation Foundation)
- 架构模式：MVVM (Model-View-ViewModel)
- 数据库：MySQL
- 依赖注入：自定义 ServiceLocator

### 2.2 项目结构
```
TCClient/
├── Models/          # 数据模型
├── ViewModels/      # 视图模型
├── Views/           # 视图
├── Services/        # 服务层
├── Utils/           # 工具类
└── docs/            # 项目文档
```

## 3. 功能模块

### 3.1 用户认证模块
#### 登录功能
- 支持用户名密码登录
- 记住密码功能
- 数据库连接选择
- 登录状态保持
- 错误提示

#### 注册功能
- 用户名唯一性验证
- 密码强度验证
- 密码确认
- 密码可见性切换
- 错误提示

### 3.2 数据库配置模块
- 数据库连接管理
- 连接测试功能
- 连接信息本地保存
- 多数据库连接支持

## 4. 数据库设计

### 4.1 用户表 (users)
```sql
CREATE TABLE users (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    username VARCHAR(50) NOT NULL UNIQUE,
    password_hash VARCHAR(100) NOT NULL COMMENT '密码哈希',
    email VARCHAR(100),
    last_login_time DATETIME,
    status TINYINT DEFAULT 1 COMMENT '状态：1-正常，0-禁用',
    create_time DATETIME DEFAULT CURRENT_TIMESTAMP,
    update_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);
```

### 4.2 数据库连接配置
- 本地配置文件存储数据库连接信息
- 支持多个数据库连接配置
- 连接信息加密存储

## 5. 程序流程

### 5.1 启动流程
1. 应用程序启动
2. 注册核心服务（数据库服务、消息服务）
3. 显示登录窗口
4. 加载保存的数据库连接配置
5. 加载保存的用户凭据（如果启用记住密码）

### 5.2 登录流程
1. 用户选择数据库连接
2. 输入用户名和密码
3. 点击登录按钮
4. 验证用户凭据
5. 登录成功：
   - 保存用户凭据（如果启用记住密码）
   - 打开主窗口
   - 关闭登录窗口
6. 登录失败：
   - 显示错误信息
   - 保持登录窗口打开

### 5.3 注册流程
1. 从登录窗口打开注册窗口
2. 输入用户名和密码
3. 点击注册按钮
4. 验证输入信息
5. 注册成功：
   - 显示成功消息
   - 关闭注册窗口
   - 返回登录窗口
6. 注册失败：
   - 显示错误信息
   - 保持注册窗口打开

### 5.4 数据库配置流程
1. 从登录窗口打开数据库配置窗口
2. 添加/编辑数据库连接信息
3. 测试连接
4. 保存配置
5. 更新登录窗口的数据库连接列表

## 6. 安全特性

### 6.1 密码安全
- 密码使用 SHA256 哈希存储
- 密码传输加密
- 密码输入框支持显示/隐藏

### 6.2 数据安全
- 数据库连接信息本地加密存储
- 用户凭据可选加密存储
- 敏感信息不显示明文

## 7. 用户界面

### 7.1 登录窗口
- 数据库连接选择
- 用户名输入
- 密码输入（带显示/隐藏功能）
- 记住密码选项
- 登录/注册按钮
- 数据库配置按钮

### 7.2 注册窗口
- 用户名输入
- 密码输入（带显示/隐藏功能）
- 确认密码输入
- 注册/取消按钮
- 错误信息显示

### 7.3 数据库配置窗口
- 连接信息输入
- 连接测试功能
- 保存/取消按钮
- 连接列表管理

## 8. 后续优化方向

1. 用户管理
   - 添加用户角色管理
   - 实现密码重置功能
   - 添加用户信息编辑功能

2. 数据库功能
   - 支持更多数据库类型
   - 添加数据库连接池
   - 实现数据库备份功能

3. 界面优化
   - 添加主题切换功能
   - 优化错误提示方式
   - 添加操作日志记录

4. 安全性
   - 实现更安全的密码加密方式
   - 添加登录尝试次数限制
   - 实现会话超时机制 